# ===================================================================================================================== 
#  DESCRIPTION: 
#  The codes give the forest plots of the C-index results computed by cox test
# ===================================================================================================================== 
#  INPUTS:
#  - C-index of each method
#  - mean (from cox test)
#  - lower (from cox test)
#  - upper (from cox test)
# ===================================================================================================================== 
#  OUTPUTS:
#  - Forest plots for C-index results in each scoring system
# ===================================================================================================================== 
#  Codes produced by: 
#  - Elham Majd
# ===================================================================================================================== 
#  HISTORY:
#  - Creation: Feb/2022
# ===================================================================================================================== 
# STATEMENT:
#   This file is part of a project entitled "Predicting Tumor Response and 
#   Overall Survival Using Early Outcomes and Baseline Characteristics"
# =====================================================================================================================
# Libraries 
# =====================================================================================================================
# install.packages("forestplot",repos = "http://cran.us.r-project.org")

# load package
library(forestplot)
library(dplyr)
# =====================================================================================================================

cochrane_from_rmeta<- structure(list(mean  = c(NA, NA,1.37,	1.00,	0.84,	2.50,	1.89,	0.96,	1.44,	4.48,	1.71,	0.66,	1.61,	1.06,	2.38,	0.98,	1.09,	1.20,	2.68,	0.67,	2.44,	1.01,	1.13,	0.89,	0.75, NA),
                                     lower = c(NA, NA, 1.24,	0.94,	0.75,	2.31,	1.42,	0.23,	1.32,	1.94,	0.06,	0.26,	1.11,	1.00,	0.58,	0.86,	0.58,	0.62,	1.92,	0.42,	0.28,	1.00,	1.07,	0.80,	0.70, NA),
                                     upper = c(NA, NA,	1.49,	1.05,	0.93,	2.68,	2.35,	1.68,	1.56,	7.02,	3.36,	1.06,	2.12,	1.12,	4.18,	1.09,	1.60,	1.79,	3.43,	0.92,	4.59,	1.03,	1.20,	0.97,	0.80, NA)),
                                .Names = c("mean", "lower", "upper"),
                                row.names = c(NA, -27L),
                                class = "data.frame")

tabletext <- cbind(c("","DATASET", "NCT00384176",	"NCT01439568",	"NCT02499770", 	"NCT03041311",	"NCT00364013",	"NCT00460265",	"NCT00094081",
                     "NCT00115765",	"NCT00988208",	"NCT00532155",	"NCT00290966",	"NCT00305188",	"NCT00272051",	"NCT01016483",	"NCT00540514",	
                     "NCT00574275",	"NCT00081796",	"NCT00417079",	"NCT00519285",	"NCT02514447",	"NCT00522834",	"NCT00113763",	"NCT00339183", NA),
                   c("C-INDEX", "",0.52,  0.50,	0.51,	0.57,	0.60,	0.53,	0.57,	0.62,	0.55,	0.54,	0.57,	0.50,	0.51,	0.50,	0.50,	0.49,	0.67,	0.51,	0.50,	0.50,	0.51,	0.51,	0.52, NA))

fplot1<- cochrane_from_rmeta %>% 
  forestplot(labeltext = tabletext, 
             clip = c(0.1, 2.0), 
             col = fpColors(box = "darkred",
                            line = "darkred"))

png("./Figures/cindex-method1.png", width=480, height=480)

fplot1

# save plot
dev.copy(png, "./Figures/cindex-method1.png")
dev.off()

