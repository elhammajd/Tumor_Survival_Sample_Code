# ===================================================================================================================== 
#  DESCRIPTION: 
#  The codes give the forest plots of the C-index results computed by cox test
# ===================================================================================================================== 
#  INPUTS:
#  - C-index of each method
#  - mean (from cox test)
#  - lower (from cox test)
#  - upper (from cox test)
# ===================================================================================================================== 
#  OUTPUTS:
#  - Forest plots for C-index results in each scoring system
# ===================================================================================================================== 
#  Codes produced by: 
#  - Elham Majd
# ===================================================================================================================== 
#  HISTORY:
#  - Creation: Feb/2022
# ===================================================================================================================== 
# STATEMENT:
#   This file is part of a project entitled "Predicting Tumor Response and 
#   Overall Survival Using Early Outcomes and Baseline Characteristics"
# =====================================================================================================================
# Libraries 
# =====================================================================================================================
install.packages("forestplot",repos = "http://cran.us.r-project.org")

# load package
library(forestplot)
library(dplyr)
# =====================================================================================================================


cochrane_from_rmeta<- structure(list(mean  = c(NA, NA, 1.52,  1.62,	1.08,	1.26,	0.49,	1.76,	0.78,	0.39,	6.81,	1.74,	0.84,	1.00,	2.29,	0.74,	1.03,	1.16,	2.34,	0.86,	2.51,	1.55,	0.91,	1.11,	2.65, NA),
                                     lower = c(NA, NA, 0.98,  1.07,	0.81,	1.05,	0.34,	0.43,	0.62,	0.11,	0.24,	0.92,	0.42,	0.90,	1.10,	0.55,	0.68,	0.82,	1.68,	0.74,	1.69,	1.41,	0.78,	0.84,	2.51, NA),
                                     upper = c(NA, NA, 2.06,  2.18,	1.36,	1.48,	0.63,	3.09,	0.94,	0.67,	13.38,	2.56,	1.26,	1.11,	3.48,	0.93,	1.37,	1.50,	3.00,	0.99,	3.33,	1.69,	1.05,	1.38,	2.78, NA)),
                                .Names = c("mean", "lower", "upper"),
                                row.names = c(NA, -27L),
                                class = "data.frame")

tabletext <- cbind(c("","DATASET", "NCT00384176",	"NCT01439568",	"NCT02499770", 	"NCT03041311",	"NCT00364013",	"NCT00460265",	"NCT00094081",
                     "NCT00115765",	"NCT00988208",	"NCT00532155",	"NCT00290966",	"NCT00305188",	"NCT00272051",	"NCT01016483",	"NCT00540514",	
                     "NCT00574275",	"NCT00081796",	"NCT00417079",	"NCT00519285",	"NCT02514447",	"NCT00522834",	"NCT00113763",	"NCT00339183", NA),
                   c("C-INDEX", "",0.54, 0.51,	0.50,	0.55,	0.57,	0.57,	0.53,	0.63,	0.54,	0.54,	0.54,	0.50,	0.57,	0.51,	0.50,	0.55,	0.65,	0.51,	0.61,	0.59,	0.52,	0.50,	0.62, NA))

fplot3<- cochrane_from_rmeta %>% 
  forestplot(labeltext = tabletext, 
             clip = c(0.1, 2.0), 
             col = fpColors(box = "darkred",
                            line = "darkred"))

png("./Figures/cindex-method3.png", width=480, height=480)

fplot3

# save plot
dev.copy(png, "./Figures/cindex-method3.png")
dev.off()


