# ===================================================================================================================== 
#  DESCRIPTION: 
#  The codes give the forest plots of the C-index results computed by cox test
# ===================================================================================================================== 
#  INPUTS:
#  - C-index of each method
#  - mean (from cox test)
#  - lower (from cox test)
#  - upper (from cox test)
# ===================================================================================================================== 
#  OUTPUTS:
#  - Forest plots for C-index results in each scoring system
# ===================================================================================================================== 
#  Codes produced by: 
#  - Elham Majd
# ===================================================================================================================== 
#  HISTORY:
#  - Creation: Feb/2022
# ===================================================================================================================== 
# STATEMENT:
#   This file is part of a project entitled "Predicting Tumor Response and 
#   Overall Survival Using Early Outcomes and Baseline Characteristics"
# =====================================================================================================================
# Libraries 
# =====================================================================================================================
# install.packages("forestplot",repos = "http://cran.us.r-project.org")

# load package
library(forestplot)
library(dplyr)
# =====================================================================================================================

cochrane_from_rmeta<- structure(list(mean  = c(NA, NA, 1.19,  1.04,	0.89,	1.54,	1.98,	1.59,	1.31,	4.48,	2.20,	0.56,	1.71,	1.05,	1.15,	0.95,	1.01,	0.89,	2.20,	0.84,	1.39,	1.01,	1.08,	1.10,	0.55, NA),
                                     lower = c(NA, NA, 1.08,	1.00,	0.82,	1.44,	1.49,	0.52,	1.21,	1.94,	0.08,	0.20,	1.19,	1.00,	0.33,	0.88,	0.75,	0.58,	1.59,	0.59,	0.40,	1.00,	1.03,	1.02,	0.48, NA),
                                     upper = c(NA, NA, 1.30,  1.09,	0.96,	1.64,	2.46,	2.67,	1.42,	7.02,	4.32,	0.92,	2.22,	1.10,	1.98,	1.02,	1.26,	1.20,	2.82,	1.09,	2.37,	1.02,	1.13,	1.18,	0.62, NA)),
                                .Names = c("mean", "lower", "upper"),
                                row.names = c(NA, -27L),
                                class = "data.frame")

tabletext <- cbind(c("","DATASET", "NCT00384176",	"NCT01439568",	"NCT02499770", 	"NCT03041311",	"NCT00364013",	"NCT00460265",	"NCT00094081",
                     "NCT00115765",	"NCT00988208",	"NCT00532155",	"NCT00290966",	"NCT00305188",	"NCT00272051",	"NCT01016483",	"NCT00540514",	
                     "NCT00574275",	"NCT00081796",	"NCT00417079",	"NCT00519285",	"NCT02514447",	"NCT00522834",	"NCT00113763",	"NCT00339183", NA),
                   c("C-INDEX", "",0.51,  0.49,	0.51,	0.54,	0.61,	0.49,	0.56,	0.62,	0.54,	0.57,	0.58,	0.50,	0.50,	0.50,	0.50,	0.52,	0.64,	0.51,	0.50,	0.50,	0.51,	0.50,	0.51, NA))


fplot2<- cochrane_from_rmeta %>% 
  forestplot(labeltext = tabletext, 
             clip = c(0.1, 2.0), 
             col = fpColors(box = "darkred",
                            line = "darkred"))

png("./Figures/cindex-method2.png", width=480, height=480)

fplot2

# save plot
dev.copy(png, "./Figures/cindex-method2.png")
dev.off()
